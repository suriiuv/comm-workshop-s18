<!DOCTYPE html>
<html>
<head>
	<title>Bar Chart Demo</title>
</head>
<body>
	<!-- this imports the D3 library -->
	<script src="https://d3js.org/d3.v4.min.js"></script>

	<script>
		//array of numbers
		var dataset = [
			["Alabama","22288","01"],
			["Alaska","27734","02"],
			["Arizona","56694","04"],
			["Arkansas","21673","05"],
			["California","458523","06"],
			["Colorado","77376","08"],
			["Connecticut","53146","09"],
			["Delaware","9258","10"],
			["District of Columbia","43226","11"],
			["Florida","125170","12"],
			["Georgia","68134","13"],
			["Hawaii","30644","15"],
			["Idaho","21161","16"],
			["Illinois","185070","17"],
			["Indiana","62432","18"],
			["Iowa","54613","19"],
			["Kansas","32837","20"],
			["Kentucky","43877","21"],
			["Louisiana","37652","22"],
			["Maine","25475","23"],
			["Maryland","70705","24"],
			["Massachusetts","161164","25"],
			["Michigan","94664","26"],
			["Minnesota","78431","27"],
			["Mississippi","18179","28"],
			["Missouri","54216","29"],
			["Montana","23410","30"],
			["Nebraska","26868","31"],
			["Nevada","27147","32"],
			["New Hampshire","19449","33"],
			["New Jersey","129023","34"],
			["New Mexico","19523","35"],
			["New York","580469","36"],
			["North Carolina","78111","37"],
			["North Dakota","15087","38"],
			["Ohio","120843","39"],
			["Oklahoma","30266","40"],
			["Oregon","70555","41"],
			["Pennsylvania","227520","42"],
			["Rhode Island","18859","44"],
			["South Carolina","45996","45"],
			["South Dakota","16811","46"],
			["Tennessee","38119","47"],
			["Texas","192491","48"],
			["Utah","33396","49"],
			["Vermont","18360","50"],
			["Virginia","92849","51"],
			["Washington","113083","53"],
			["West Virginia","20660","54"],
			["Wisconsin","94202","55"],
			["Wyoming","11190","56"],
			["Puerto Rico","34652","72"]
		]
		;

		//two variables for the size of the svg container
		var width = 1000;
		var height = 500;

		//two variables for the chart
		var barWidth = width/dataset.length;
		var xAxis = 400;

		//this line of code uses d3 to find the <body> tag on the page, and then injects, with .append(), an <svg> object into it
		//.attr() sets the attributes of the svg tag.
		var svg = d3.select('body')
		.append('svg')
		.attr('width', width)
		.attr('height', height)
		;
		
		//draw a rectangle as large as the svg container for background color choice
		var background = d3.select('svg')
		.append('rect')
		.attr('width', width)
		.attr('height', height)
		.attr('x', 0)
		.attr('y', 0)
		.attr('fill', "#eee")
		;

		//loop through the dataset
		for (var i = 0; i < dataset.length; i++) {
			
			//manipulate the dataset to derive a usable color value, colors come in the range 0-255, the 1500 denominator was experimentally derived.
			var color = (dataset[i][1] / 1500).toFixed(0);

			//draw bars. subtraction from a set height is used to draw from the bottom rather than the top
			var bars = d3.select('svg')
			.append('rect')
			.attr('width', barWidth)
			.attr('height', dataset[i][1] / 2000)
			.attr('x', i * barWidth)
			.attr('y', xAxis - ( dataset[i][1] / 2000))
			.attr('fill', 'rgb(' + color + ',0,0)')
			; 
			
			var abbreviation = dataset[i][0].substring(0,2)

			var text = d3.select('svg')
			.append('text')
			.text(abbreviation)
			.attr('x', (i * barWidth) + .25*barWidth)
			.attr('y', xAxis + 25)
			.style('font-size',10)
			.style('font-family','courier')
			;

		}

	</script>
</body>
</html>